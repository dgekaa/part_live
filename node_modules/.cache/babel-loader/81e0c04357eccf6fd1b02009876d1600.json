{"ast":null,"code":"import _slicedToArray from\"D:\\\\GitHub\\\\party_live_web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import GooggleMapReact from\"google-map-react\";import{Link}from\"react-router-dom\";import ReactHLS from\"react-hls\";import Popup from\"../../components/popup/Popup\";import SlideSideMenu from\"../../components/slideSideMenu/SlideSideMenu\";import BottomMenu from\"../../components/bottomMenu/BottomMenu\";import Header from\"../../components/header/Header\";import Loader from\"../../components/loader/Loader\";import{isShowStreamNow,isWorkTimeNow}from\"../../calculateTime\";import{getDistanceFromLatLonInKm}from\"../../getDistance\";import QUERY from\"../../query\";import{API_KEY}from\"../../constants\";import\"./company.css\";var Marker=function Marker(_ref){var children=_ref.children;return children;};var Company=function Company(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showPopup=_useState2[0],setShowPopap=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),DATA=_useState4[0],setDATA=_useState4[1];var _useState5=useState([0,0]),_useState6=_slicedToArray(_useState5,2),geoposition=_useState6[0],setGeoposition=_useState6[1];var dayOfWeek=[\"Понедельник\",\"Вторник\",\"Среда\",\"Четверг\",\"Пятница\",\"Суббота\",\"Воскресенье\"];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showStream=_useState8[0],setShowStream=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),workTime=_useState10[0],setWorkTime=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isWork=_useState12[0],setIsWork=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showSlideSideMenu=_useState14[0],setShowSlideSideMenu=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isShowMenu=_useState16[0],setIsShowMenu=_useState16[1];var _useState17=useState(window.innerWidth),_useState18=_slicedToArray(_useState17,2),windowWidth=_useState18[0],setWindowWidth=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),isLoading=_useState20[0],setIsLoading=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),curDistance=_useState22[0],setCurDistance=_useState22[1];var numberDayNow=new Date().getDay()===0?6:new Date().getDay()-1;useEffect(function(){if(DATA){isShowStreamNow(DATA.place,setShowStream);isWorkTimeNow(DATA.place,setWorkTime,setIsWork);}},[DATA]);useEffect(function(){if(DATA){setGeoposition([+DATA.place.coordinates.split(\",\")[0],+DATA.place.coordinates.split(\",\")[1]]);}},[DATA]);useEffect(function(){QUERY({query:\"query {\\n        place (id: \".concat(props.match.params.id,\") {\\n          id name address description\\n          streams{url name id preview\\n            schedules{id day start_time end_time}\\n          }\\n          categories{name slug}\\n          coordinates\\n          schedules {day start_time end_time}\\n          user {id name email}\\n        }\\n      }\")}).then(function(res){return res.json();}).then(function(data){setIsLoading(false);setDATA(data.data);}).catch(function(err){console.log(err,\"  ONE PLACE\");});},[]);var togglePopup=function togglePopup(){showPopup?setShowPopap(false):setShowPopap(true);};var hideSideMenu=function hideSideMenu(){setShowSlideSideMenu(false);document.body.style.overflow=\"visible\";setIsShowMenu(false);};var showSideMenu=function showSideMenu(){setShowSlideSideMenu(true);document.body.style.overflow=\"hidden\";setIsShowMenu(true);};window.onresize=function(e){setWindowWidth(e.target.innerWidth);hideSideMenu();};if(navigator.geolocation&&DATA){navigator.geolocation.getCurrentPosition(function(pos){setCurDistance(getDistanceFromLatLonInKm(pos.coords.latitude,pos.coords.longitude,DATA.place.coordinates.split(\",\")[0],DATA.place.coordinates.split(\",\")[1]));},function(err){console.log(err,\" GEOLOCATION ERROR \");});}else{console.log(\"Геолокация недоступна \");}return React.createElement(\"div\",{onClick:function onClick(e){if(e.target.className!==\"SlideSideMenu\"&&showSlideSideMenu){hideSideMenu();}}},React.createElement(\"div\",{className:\"Company\",style:isShowMenu?{animation:\"toLeft 0.3s ease\",position:\"relative\",right:\"200px\"}:{animation:\"toRight 0.3s ease\",position:\"relative\"},onClick:function onClick(e){if(e.target.className!==\"SlideSideMenu\"&&showSlideSideMenu){hideSideMenu();}}},windowWidth&&windowWidth>760&&React.createElement(\"div\",{className:\"bigCompanyHeader\"},React.createElement(Link,{to:\"/home\"},\" < \\u041D\\u0430 \\u0433\\u043B\\u0430\\u0432\\u043D\\u0443\\u044E\")),windowWidth&&windowWidth<760&&React.createElement(Header,{logo:true,burger:true,arrow:true,toSlideFixedHeader:isShowMenu,isShowMenu:isShowMenu,showSlideSideMenu:showSlideSideMenu,showSideMenu:showSideMenu}),DATA&&React.createElement(\"div\",{className:\"flex\"},React.createElement(\"div\",{className:\"shadowBlock\"},React.createElement(\"div\",{className:\"videoBlock\"},showStream&&React.createElement(ReactHLS,{url:DATA.place.streams[0].url,controls:true,autoplay:true}),!showStream&&React.createElement(\"div\",{className:\"noVideo\"},\"\\u041D\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u043C\\u043E\\u043C\\u0435\\u043D\\u0442 \\u0442\\u0440\\u0430\\u043D\\u0441\\u043B\\u044F\\u0446\\u0438\\u044F \\u043D\\u0435 \\u0437\\u0430\\u043F\\u043B\\u0430\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0430\"),React.createElement(\"div\",{className:\"showWatchPeople\"}),React.createElement(\"p\",{className:\"videoDescription\"},React.createElement(\"span\",null,DATA.place.name),\" - \",DATA.place.description)),React.createElement(\"div\",{className:\"desc\"},React.createElement(\"div\",{className:\"mobileDescription\"},React.createElement(\"h3\",null,React.createElement(\"span\",{className:\"mobileCompanyType\"},DATA.place.categories[0].name,\" \\\"\"),DATA.place.name,React.createElement(\"span\",{className:\"mobileCompanyType\"},\"\\\"\")),React.createElement(\"p\",{className:\"typeOfPati\"},\"\\u0442\\u0438\\u043F \\u043C\\u0435\\u0440\\u043E\\u043F\\u0440\\u0438\\u044F\\u0442\\u0438\\u044F?????\"),React.createElement(\"p\",{className:\"dayOfWeek\"},dayOfWeek[numberDayNow]),React.createElement(\"p\",{className:\"distance\"},curDistance&&React.createElement(\"span\",null,Number(curDistance).toFixed(2),\" km\"),!curDistance&&\" 0 km\")),React.createElement(\"p\",{className:\"smallOpenedTo\"},isWork&&React.createElement(\"span\",null,\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u043E: \\u0434\\u043E \",workTime.split(\"-\")[1]),!isWork&&\"Закрыто\"),React.createElement(\"div\",{className:\"timeBlocks\"},React.createElement(\"div\",{className:\"timeBlock\"},React.createElement(\"img\",{height:\"16\",width:\"16\",alt:\"clock\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/clock.png\")}),React.createElement(\"p\",{className:\"rightTimeBlock\"},React.createElement(\"span\",null,\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B:\"),\" \",React.createElement(\"span\",null,workTime))),React.createElement(\"div\",{className:\"timeBlock streamTime\"},React.createElement(\"img\",{height:\"16\",width:\"16\",alt:\"camera\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/camera.png\")}),React.createElement(\"p\",{className:\"rightTimeBlock\"},React.createElement(\"span\",null,\" \\u0421\\u0442\\u0440\\u0438\\u043C:\"),React.createElement(\"span\",null,showStream?\" Стрим идет\":\" Стрим не идет\"))),React.createElement(\"div\",{className:\"timeBlock\"},React.createElement(\"img\",{alt:\"location\",height:\"16\",width:\"16\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/location.png\")}),React.createElement(\"p\",{className:\"rightTimeBlock\"},React.createElement(\"span\",null,\"\\u0410\\u0434\\u0440\\u0435\\u0441: \"),React.createElement(\"span\",null,DATA.place.address)))),windowWidth&&windowWidth>760&&React.createElement(\"div\",{className:\"smallMapWrap\"},React.createElement(\"div\",{className:\"smallMap\"},React.createElement(GooggleMapReact,{onClick:function onClick(){togglePopup();}// <script type=\"text/javascript\" src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyAZQdg3dPHXD5Bt-Dgi85wNHG5G_MXpR7g&amp;&libraries=geometry,places\"></script>\n,bootstrapURLKeys:{key:API_KEY},defaultCenter:{lat:geoposition[0],lng:geoposition[1]},defaultZoom:10},React.createElement(Marker,{lat:geoposition[0],lng:geoposition[1]},React.createElement(\"button\",{className:\"mapMarkerCompany\"},React.createElement(\"img\",{alt:\"img\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/location.png\")}))))))),React.createElement(\"div\",{className:\"type\"},DATA.place.categories[0].name)),!!windowWidth&&windowWidth<=760&&React.createElement(\"div\",{className:\"smallMapWrap\"},React.createElement(\"div\",{className:\"smallMap\"},React.createElement(GooggleMapReact,{onClick:function onClick(){togglePopup();},bootstrapURLKeys:{key:API_KEY},defaultCenter:{lat:geoposition[0],lng:geoposition[1]},defaultZoom:10},React.createElement(Marker,{lat:geoposition[0],lng:geoposition[1]},React.createElement(\"button\",{className:\"mapMarkerCompany\"},React.createElement(\"img\",{alt:\"img\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/location.png\")}))))),React.createElement(\"p\",{className:\"smallMapLocation\"},DATA?DATA.place.address:\"\"))),!DATA&&isLoading&&React.createElement(Loader,null),showPopup&&React.createElement(Popup,{togglePopup:togglePopup},React.createElement(GooggleMapReact,{style:{height:\"100%\",width:\"100%\"},bootstrapURLKeys:{key:API_KEY},defaultCenter:{lat:geoposition[0],lng:geoposition[1]},defaultZoom:10},React.createElement(Marker,{lat:geoposition[0],lng:geoposition[1]},React.createElement(\"button\",{className:\"mapMarkerCompany\"},React.createElement(\"img\",{alt:\"img\",src:\"\".concat(process.env.PUBLIC_URL,\"/img/location.png\")})))),React.createElement(\"div\",{className:\"closeBtn\",onClick:togglePopup},\"\\xD7\"))),React.createElement(BottomMenu,{toSlideFixedBottomMenu:isShowMenu}),React.createElement(SlideSideMenu,{isShowMenu:isShowMenu}));};export default Company;","map":{"version":3,"sources":["D:/GitHub/party_live_web/src/pages/company/Company.js"],"names":["React","useState","useEffect","useRef","GooggleMapReact","Link","ReactHLS","Popup","SlideSideMenu","BottomMenu","Header","Loader","isShowStreamNow","isWorkTimeNow","getDistanceFromLatLonInKm","QUERY","API_KEY","Marker","children","Company","props","showPopup","setShowPopap","DATA","setDATA","geoposition","setGeoposition","dayOfWeek","showStream","setShowStream","workTime","setWorkTime","isWork","setIsWork","showSlideSideMenu","setShowSlideSideMenu","isShowMenu","setIsShowMenu","window","innerWidth","windowWidth","setWindowWidth","isLoading","setIsLoading","curDistance","setCurDistance","numberDayNow","Date","getDay","place","coordinates","split","query","match","params","id","then","res","json","data","catch","err","console","log","togglePopup","hideSideMenu","document","body","style","overflow","showSideMenu","onresize","e","target","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","className","animation","position","right","streams","url","name","description","categories","Number","toFixed","process","env","PUBLIC_URL","address","key","lat","lng","height","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport GooggleMapReact from \"google-map-react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport ReactHLS from \"react-hls\";\r\n\r\nimport Popup from \"../../components/popup/Popup\";\r\nimport SlideSideMenu from \"../../components/slideSideMenu/SlideSideMenu\";\r\nimport BottomMenu from \"../../components/bottomMenu/BottomMenu\";\r\nimport Header from \"../../components/header/Header\";\r\nimport Loader from \"../../components/loader/Loader\";\r\n\r\nimport { isShowStreamNow, isWorkTimeNow } from \"../../calculateTime\";\r\nimport { getDistanceFromLatLonInKm } from \"../../getDistance\";\r\nimport QUERY from \"../../query\";\r\nimport { API_KEY } from \"../../constants\";\r\n\r\nimport \"./company.css\";\r\n\r\nconst Marker = ({ children }) => children;\r\n\r\nconst Company = props => {\r\n  const [showPopup, setShowPopap] = useState(false);\r\n  const [DATA, setDATA] = useState(null);\r\n  const [geoposition, setGeoposition] = useState([0, 0]);\r\n  const dayOfWeek = [\r\n    \"Понедельник\",\r\n    \"Вторник\",\r\n    \"Среда\",\r\n    \"Четверг\",\r\n    \"Пятница\",\r\n    \"Суббота\",\r\n    \"Воскресенье\"\r\n  ];\r\n  const [showStream, setShowStream] = useState(false);\r\n  const [workTime, setWorkTime] = useState(false);\r\n  const [isWork, setIsWork] = useState(false);\r\n  const [showSlideSideMenu, setShowSlideSideMenu] = useState(false);\r\n  const [isShowMenu, setIsShowMenu] = useState(false);\r\n  const [windowWidth, setWindowWidth] = useState(window.innerWidth);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [curDistance, setCurDistance] = useState(null);\r\n\r\n  const numberDayNow = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;\r\n\r\n  useEffect(() => {\r\n    if (DATA) {\r\n      isShowStreamNow(DATA.place, setShowStream);\r\n      isWorkTimeNow(DATA.place, setWorkTime, setIsWork);\r\n    }\r\n  }, [DATA]);\r\n\r\n  useEffect(() => {\r\n    if (DATA) {\r\n      setGeoposition([\r\n        +DATA.place.coordinates.split(\",\")[0],\r\n        +DATA.place.coordinates.split(\",\")[1]\r\n      ]);\r\n    }\r\n  }, [DATA]);\r\n\r\n  useEffect(() => {\r\n    QUERY({\r\n      query: `query {\r\n        place (id: ${props.match.params.id}) {\r\n          id name address description\r\n          streams{url name id preview\r\n            schedules{id day start_time end_time}\r\n          }\r\n          categories{name slug}\r\n          coordinates\r\n          schedules {day start_time end_time}\r\n          user {id name email}\r\n        }\r\n      }`\r\n    })\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(data => {\r\n        setIsLoading(false);\r\n        setDATA(data.data);\r\n      })\r\n      .catch(err => {\r\n        console.log(err, \"  ONE PLACE\");\r\n      });\r\n  }, []);\r\n\r\n  const togglePopup = () => {\r\n    showPopup ? setShowPopap(false) : setShowPopap(true);\r\n  };\r\n\r\n  const hideSideMenu = () => {\r\n    setShowSlideSideMenu(false);\r\n    document.body.style.overflow = \"visible\";\r\n    setIsShowMenu(false);\r\n  };\r\n\r\n  const showSideMenu = () => {\r\n    setShowSlideSideMenu(true);\r\n    document.body.style.overflow = \"hidden\";\r\n    setIsShowMenu(true);\r\n  };\r\n\r\n  window.onresize = function(e) {\r\n    setWindowWidth(e.target.innerWidth);\r\n    hideSideMenu();\r\n  };\r\n\r\n  if (navigator.geolocation && DATA) {\r\n    navigator.geolocation.getCurrentPosition(\r\n      pos => {\r\n        setCurDistance(\r\n          getDistanceFromLatLonInKm(\r\n            pos.coords.latitude,\r\n            pos.coords.longitude,\r\n            DATA.place.coordinates.split(\",\")[0],\r\n            DATA.place.coordinates.split(\",\")[1]\r\n          )\r\n        );\r\n      },\r\n      err => {\r\n        console.log(err, \" GEOLOCATION ERROR \");\r\n      }\r\n    );\r\n  } else {\r\n    console.log(\"Геолокация недоступна \");\r\n  }\r\n\r\n  return (\r\n    <div\r\n      onClick={e => {\r\n        if (e.target.className !== \"SlideSideMenu\" && showSlideSideMenu) {\r\n          hideSideMenu();\r\n        }\r\n      }}\r\n    >\r\n      <div\r\n        className=\"Company\"\r\n        style={\r\n          isShowMenu\r\n            ? {\r\n                animation: \"toLeft 0.3s ease\",\r\n                position: \"relative\",\r\n                right: \"200px\"\r\n              }\r\n            : {\r\n                animation: \"toRight 0.3s ease\",\r\n                position: \"relative\"\r\n              }\r\n        }\r\n        onClick={e => {\r\n          if (e.target.className !== \"SlideSideMenu\" && showSlideSideMenu) {\r\n            hideSideMenu();\r\n          }\r\n        }}\r\n      >\r\n        {windowWidth && windowWidth > 760 && (\r\n          <div className=\"bigCompanyHeader\">\r\n            <Link to=\"/home\"> &#60; На главную</Link>\r\n          </div>\r\n        )}\r\n        {windowWidth && windowWidth < 760 && (\r\n          <Header\r\n            logo\r\n            burger\r\n            arrow\r\n            toSlideFixedHeader={isShowMenu}\r\n            isShowMenu={isShowMenu}\r\n            showSlideSideMenu={showSlideSideMenu}\r\n            showSideMenu={showSideMenu}\r\n          />\r\n        )}\r\n        {DATA && (\r\n          <div className=\"flex\">\r\n            <div className=\"shadowBlock\">\r\n              <div className=\"videoBlock\">\r\n                {showStream && (\r\n                  <ReactHLS\r\n                    url={DATA.place.streams[0].url}\r\n                    controls={true}\r\n                    autoplay={true}\r\n                  />\r\n                )}\r\n                {!showStream && (\r\n                  <div className=\"noVideo\">\r\n                    На данный момент трансляция не запланирована\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"showWatchPeople\"></div>\r\n                <p className=\"videoDescription\">\r\n                  <span>{DATA.place.name}</span> - {DATA.place.description}\r\n                </p>\r\n              </div>\r\n              <div className=\"desc\">\r\n                <div className=\"mobileDescription\">\r\n                  <h3>\r\n                    <span className=\"mobileCompanyType\">\r\n                      {DATA.place.categories[0].name} \"\r\n                    </span>\r\n                    {DATA.place.name}\r\n                    <span className=\"mobileCompanyType\">\"</span>\r\n                  </h3>\r\n                  <p className=\"typeOfPati\">тип мероприятия?????</p>\r\n                  <p className=\"dayOfWeek\">{dayOfWeek[numberDayNow]}</p>\r\n                  <p className=\"distance\">\r\n                    {curDistance && (\r\n                      <span>{Number(curDistance).toFixed(2)} km</span>\r\n                    )}\r\n                    {!curDistance && \" 0 km\"}\r\n                  </p>\r\n                </div>\r\n                <p className=\"smallOpenedTo\">\r\n                  {isWork && <span>Открыто: до {workTime.split(\"-\")[1]}</span>}\r\n                  {!isWork && \"Закрыто\"}\r\n                </p>\r\n                <div className=\"timeBlocks\">\r\n                  <div className=\"timeBlock\">\r\n                    <img\r\n                      height=\"16\"\r\n                      width=\"16\"\r\n                      alt=\"clock\"\r\n                      src={`${process.env.PUBLIC_URL}/img/clock.png`}\r\n                    />\r\n                    <p className=\"rightTimeBlock\">\r\n                      <span>Время работы:</span> <span>{workTime}</span>\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"timeBlock streamTime\">\r\n                    <img\r\n                      height=\"16\"\r\n                      width=\"16\"\r\n                      alt=\"camera\"\r\n                      src={`${process.env.PUBLIC_URL}/img/camera.png`}\r\n                    />\r\n                    <p className=\"rightTimeBlock\">\r\n                      <span> Стрим:</span>\r\n                      <span>\r\n                        {showStream ? \" Стрим идет\" : \" Стрим не идет\"}\r\n                      </span>\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"timeBlock\">\r\n                    <img\r\n                      alt=\"location\"\r\n                      height=\"16\"\r\n                      width=\"16\"\r\n                      src={`${process.env.PUBLIC_URL}/img/location.png`}\r\n                    />\r\n                    <p className=\"rightTimeBlock\">\r\n                      <span>Адрес: </span>\r\n                      <span>{DATA.place.address}</span>\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                {windowWidth && windowWidth > 760 && (\r\n                  <div className=\"smallMapWrap\">\r\n                    <div className=\"smallMap\">\r\n                      <GooggleMapReact\r\n                        onClick={() => {\r\n                          togglePopup();\r\n                        }}\r\n                        // <script type=\"text/javascript\" src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyAZQdg3dPHXD5Bt-Dgi85wNHG5G_MXpR7g&amp;&libraries=geometry,places\"></script>\r\n                        bootstrapURLKeys={{\r\n                          key: API_KEY\r\n                        }}\r\n                        defaultCenter={{\r\n                          lat: geoposition[0],\r\n                          lng: geoposition[1]\r\n                        }}\r\n                        defaultZoom={10}\r\n                      >\r\n                        <Marker lat={geoposition[0]} lng={geoposition[1]}>\r\n                          <button className=\"mapMarkerCompany\">\r\n                            <img\r\n                              alt=\"img\"\r\n                              src={`${process.env.PUBLIC_URL}/img/location.png`}\r\n                            ></img>\r\n                          </button>\r\n                        </Marker>\r\n                      </GooggleMapReact>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"type\">{DATA.place.categories[0].name}</div>\r\n            </div>\r\n            {!!windowWidth && windowWidth <= 760 && (\r\n              <div className=\"smallMapWrap\">\r\n                <div className=\"smallMap\">\r\n                  <GooggleMapReact\r\n                    onClick={() => {\r\n                      togglePopup();\r\n                    }}\r\n                    bootstrapURLKeys={{\r\n                      key: API_KEY\r\n                    }}\r\n                    defaultCenter={{\r\n                      lat: geoposition[0],\r\n                      lng: geoposition[1]\r\n                    }}\r\n                    defaultZoom={10}\r\n                  >\r\n                    <Marker lat={geoposition[0]} lng={geoposition[1]}>\r\n                      <button className=\"mapMarkerCompany\">\r\n                        <img\r\n                          alt=\"img\"\r\n                          src={`${process.env.PUBLIC_URL}/img/location.png`}\r\n                        ></img>\r\n                      </button>\r\n                    </Marker>\r\n                  </GooggleMapReact>\r\n                </div>\r\n                <p className=\"smallMapLocation\">\r\n                  {DATA ? DATA.place.address : \"\"}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        {!DATA && isLoading && <Loader />}\r\n        {showPopup && (\r\n          <Popup togglePopup={togglePopup}>\r\n            <GooggleMapReact\r\n              style={{ height: \"100%\", width: \"100%\" }}\r\n              bootstrapURLKeys={{\r\n                key: API_KEY\r\n              }}\r\n              defaultCenter={{\r\n                lat: geoposition[0],\r\n                lng: geoposition[1]\r\n              }}\r\n              defaultZoom={10}\r\n            >\r\n              <Marker lat={geoposition[0]} lng={geoposition[1]}>\r\n                <button className=\"mapMarkerCompany\">\r\n                  <img\r\n                    alt=\"img\"\r\n                    src={`${process.env.PUBLIC_URL}/img/location.png`}\r\n                  ></img>\r\n                </button>\r\n              </Marker>\r\n            </GooggleMapReact>\r\n            <div className=\"closeBtn\" onClick={togglePopup}>\r\n              &#215;\r\n            </div>\r\n          </Popup>\r\n        )}\r\n      </div>\r\n      <BottomMenu toSlideFixedBottomMenu={isShowMenu} />\r\n      <SlideSideMenu isShowMenu={isShowMenu} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Company;\r\n"]},"metadata":{},"sourceType":"module"}