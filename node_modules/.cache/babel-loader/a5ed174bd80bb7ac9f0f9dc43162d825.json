{"ast":null,"code":"import _slicedToArray from\"D:\\\\GitHub\\\\party_live_web\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from\"react\";import{useCookies}from\"react-cookie\";import{Redirect}from\"react-router-dom\";import Header from\"../../components/header/Header\";import SlideSideMenu from\"../../components/slideSideMenu/SlideSideMenu\";import QUERY from\"../../query\";import\"./auth.css\";var Login=function Login(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showSlideSideMenu=_useState2[0],setShowSlideSideMenu=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isShowMenu=_useState4[0],setIsShowMenu=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLogin=_useState6[0],setIsLogin=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),email=_useState8[0],setEmail=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),password=_useState10[0],setPassword=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isForgetPass=_useState12[0],setIsForgetPass=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),allValidationError=_useState14[0],setAllValidationError=_useState14[1];var loginRef=useRef(null);var _useCookies=useCookies([]),_useCookies2=_slicedToArray(_useCookies,3),cookies=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var hideSideMenu=function hideSideMenu(){setShowSlideSideMenu(false);document.body.style.overflow=\"visible\";setIsShowMenu(false);};var showSideMenu=function showSideMenu(){setShowSlideSideMenu(true);document.body.style.overflow=\"hidden\";setIsShowMenu(true);};var userLogin=function userLogin(email,password){QUERY({query:\"mutation {\\n        login (input: {\\n            username: \\\"\".concat(email,\"\\\",\\n            password: \\\"\").concat(password,\"\\\"\\n        }) {access_token refresh_token expires_in token_type\\n          user {id name email}\\n        }\\n      }\")}).then(function(res){return res.json();}).then(function(data){if(!data.errors){console.log(data,\" LOGIN\");setCookie(\"origin_data\",data.data.login.access_token);setCookie(\"origin_id\",data.data.login.user.id);for(var i=0;i<loginRef.current.children.length-1;i++){loginRef.current.children[i].style.boxShadow=\"none\";}setAllValidationError(\"\");setIsLogin(true);}else{removeCookie(\"origin_data\");removeCookie(\"origin_id\");setAllValidationError(\"Неверный логин либо пароль\");for(var _i=0;_i<loginRef.current.children.length-1;_i++){loginRef.current.children[_i].style.boxShadow=\"0 0 1px 1px rgb(255, 54, 54)\";}setIsLogin(false);console.log(data.errors[0],\"------------------ERR\");}}).catch(function(err){removeCookie(\"origin_data\");removeCookie(\"origin_id\");setIsLogin(false);console.log(err,\"  *****************ERR\");});};if(isLogin||Number(cookies.origin_id)===1){return React.createElement(Redirect,{to:\"/editCompany\"});}else{return React.createElement(\"div\",{className:\"Login\",onClick:function onClick(e){if(e.target.className!==\"SlideSideMenu\"&&showSlideSideMenu){hideSideMenu();}},style:isShowMenu?{animation:\"toLeft 0.3s ease\",position:\"relative\",right:\"200px\"}:{animation:\"toRight 0.3s ease\",position:\"relative\"}},React.createElement(Header,{logo:true,burger:true,toSlideFixedHeader:isShowMenu,showSlideSideMenu:showSlideSideMenu,showSideMenu:showSideMenu}),React.createElement(\"div\",{className:\"authBlock\"},React.createElement(\"h4\",null,!isForgetPass?\"АВТОРИЗАЦИЯ\":\"ВОССТАНОВЛЕНИЕ ПАРОЛЯ\"),React.createElement(\"form\",{ref:loginRef,onSubmit:function onSubmit(e){e.preventDefault();!isForgetPass&&userLogin(email,password);}},React.createElement(\"input\",{type:\"text\",name:\"email\",placeholder:\"email\",value:email,onChange:function onChange(e){setEmail(e.target.value);}}),!isForgetPass&&React.createElement(\"input\",{type:\"password\",name:\"password\",placeholder:\"password\",value:password,onChange:function onChange(e){setPassword(e.target.value);}}),!isForgetPass&&React.createElement(\"input\",{type:\"submit\",value:\"\\u0412\\u041E\\u0419\\u0422\\u0418\"}),isForgetPass&&React.createElement(\"p\",{className:\"btnSubmit\"},\"\\u041E\\u0422\\u041F\\u0420\\u0410\\u0412\\u0418\\u0422\\u042C\")),React.createElement(\"p\",{className:\"forgetPass\",onClick:function onClick(){setIsForgetPass(function(prev){return!prev;});}},!isForgetPass?\"  Забыли пароль?\":\" Уже есть аккаунт?\",React.createElement(\"span\",{className:\"errorField\"},!isForgetPass&&allValidationError))),React.createElement(SlideSideMenu,{isShowMenu:isShowMenu}));}};export default Login;","map":{"version":3,"sources":["D:/GitHub/party_live_web/src/pages/auth/Login.js"],"names":["React","useState","useRef","useCookies","Redirect","Header","SlideSideMenu","QUERY","Login","showSlideSideMenu","setShowSlideSideMenu","isShowMenu","setIsShowMenu","isLogin","setIsLogin","email","setEmail","password","setPassword","isForgetPass","setIsForgetPass","allValidationError","setAllValidationError","loginRef","cookies","setCookie","removeCookie","hideSideMenu","document","body","style","overflow","showSideMenu","userLogin","query","then","res","json","data","errors","console","log","login","access_token","user","id","i","current","children","length","boxShadow","catch","err","Number","origin_id","e","target","className","animation","position","right","preventDefault","value","prev"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\r\nimport { useCookies } from \"react-cookie\";\r\n\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Header from \"../../components/header/Header\";\r\nimport SlideSideMenu from \"../../components/slideSideMenu/SlideSideMenu\";\r\n\r\nimport QUERY from \"../../query\";\r\n\r\nimport \"./auth.css\";\r\n\r\nconst Login = () => {\r\n  const [showSlideSideMenu, setShowSlideSideMenu] = useState(false);\r\n  const [isShowMenu, setIsShowMenu] = useState(false);\r\n  const [isLogin, setIsLogin] = useState(false);\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [isForgetPass, setIsForgetPass] = useState(false);\r\n  const [allValidationError, setAllValidationError] = useState(\"\");\r\n  const loginRef = useRef(null);\r\n  const [cookies, setCookie, removeCookie] = useCookies([]);\r\n\r\n  const hideSideMenu = () => {\r\n    setShowSlideSideMenu(false);\r\n    document.body.style.overflow = \"visible\";\r\n    setIsShowMenu(false);\r\n  };\r\n\r\n  const showSideMenu = () => {\r\n    setShowSlideSideMenu(true);\r\n    document.body.style.overflow = \"hidden\";\r\n    setIsShowMenu(true);\r\n  };\r\n\r\n  const userLogin = (email, password) => {\r\n    QUERY({\r\n      query: `mutation {\r\n        login (input: {\r\n            username: \"${email}\",\r\n            password: \"${password}\"\r\n        }) {access_token refresh_token expires_in token_type\r\n          user {id name email}\r\n        }\r\n      }`\r\n    })\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(data => {\r\n        if (!data.errors) {\r\n          console.log(data, \" LOGIN\");\r\n          setCookie(\"origin_data\", data.data.login.access_token);\r\n          setCookie(\"origin_id\", data.data.login.user.id);\r\n\r\n          for (let i = 0; i < loginRef.current.children.length - 1; i++) {\r\n            loginRef.current.children[i].style.boxShadow = \"none\";\r\n          }\r\n\r\n          setAllValidationError(\"\");\r\n          setIsLogin(true);\r\n        } else {\r\n          removeCookie(\"origin_data\");\r\n          removeCookie(\"origin_id\");\r\n\r\n          setAllValidationError(\"Неверный логин либо пароль\");\r\n\r\n          for (let i = 0; i < loginRef.current.children.length - 1; i++) {\r\n            loginRef.current.children[i].style.boxShadow =\r\n              \"0 0 1px 1px rgb(255, 54, 54)\";\r\n          }\r\n          setIsLogin(false);\r\n          console.log(data.errors[0], \"------------------ERR\");\r\n        }\r\n      })\r\n      .catch(err => {\r\n        removeCookie(\"origin_data\");\r\n        removeCookie(\"origin_id\");\r\n\r\n        setIsLogin(false);\r\n        console.log(err, \"  *****************ERR\");\r\n      });\r\n  };\r\n\r\n  if (isLogin || Number(cookies.origin_id) === 1) {\r\n    return <Redirect to=\"/editCompany\" />;\r\n  } else {\r\n    return (\r\n      <div\r\n        className=\"Login\"\r\n        onClick={e => {\r\n          if (e.target.className !== \"SlideSideMenu\" && showSlideSideMenu) {\r\n            hideSideMenu();\r\n          }\r\n        }}\r\n        style={\r\n          isShowMenu\r\n            ? {\r\n                animation: \"toLeft 0.3s ease\",\r\n                position: \"relative\",\r\n                right: \"200px\"\r\n              }\r\n            : {\r\n                animation: \"toRight 0.3s ease\",\r\n                position: \"relative\"\r\n              }\r\n        }\r\n      >\r\n        <Header\r\n          logo\r\n          burger\r\n          toSlideFixedHeader={isShowMenu}\r\n          showSlideSideMenu={showSlideSideMenu}\r\n          showSideMenu={showSideMenu}\r\n        />\r\n        <div className=\"authBlock\">\r\n          <h4>{!isForgetPass ? \"АВТОРИЗАЦИЯ\" : \"ВОССТАНОВЛЕНИЕ ПАРОЛЯ\"}</h4>\r\n          <form\r\n            ref={loginRef}\r\n            onSubmit={e => {\r\n              e.preventDefault();\r\n              !isForgetPass && userLogin(email, password);\r\n            }}\r\n          >\r\n            <input\r\n              type=\"text\"\r\n              name=\"email\"\r\n              placeholder=\"email\"\r\n              value={email}\r\n              onChange={e => {\r\n                setEmail(e.target.value);\r\n              }}\r\n            />\r\n            {!isForgetPass && (\r\n              <input\r\n                type=\"password\"\r\n                name=\"password\"\r\n                placeholder=\"password\"\r\n                value={password}\r\n                onChange={e => {\r\n                  setPassword(e.target.value);\r\n                }}\r\n              />\r\n            )}\r\n            {!isForgetPass && <input type=\"submit\" value=\"ВОЙТИ\" />}\r\n            {isForgetPass && <p className=\"btnSubmit\">ОТПРАВИТЬ</p>}\r\n          </form>\r\n          <p\r\n            className=\"forgetPass\"\r\n            onClick={() => {\r\n              setIsForgetPass(prev => !prev);\r\n            }}\r\n          >\r\n            {!isForgetPass ? \"  Забыли пароль?\" : \" Уже есть аккаунт?\"}\r\n            <span className=\"errorField\">\r\n              {!isForgetPass && allValidationError}\r\n            </span>\r\n          </p>\r\n        </div>\r\n        <SlideSideMenu isShowMenu={isShowMenu} />\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}